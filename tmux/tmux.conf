# tmux.conf 기본 설정 파일

# 기본 설정
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -g history-limit 20000
set -g buffer-limit 20
set -g mouse on

# vi 모드 활성화
set-window-option -g mode-keys vi

# copy-mode 내에서 vi 키 바인딩 설정
bind -T copy-mode-vi v send -X begin-selection      # 'v'로 선택 시작
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"  # 'y'로 복사
bind -T copy-mode-vi r send -X rectangle-toggle     # 'r'로 사각형 선택 모드 토글
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "pbcopy"  # 드래그 & 복사하면 클립보드로
set -g escape-time 10
set -g display-time 4000
set -g status-interval 5
set -g focus-events on

# 키 바인딩 설정
unbind C-b
set -g prefix C-e  # 프리픽스 키를 Ctrl+E로 변경
bind C-e send-prefix

# 대체 키 설정: Ctrl+h, Ctrl+j, Ctrl+k, Ctrl+l 키 바인딩 제거 (다른 프로그램과의 충돌 방지)
# bind -n C-h select-pane -L
# bind -n C-j select-pane -D
# bind -n C-k select-pane -U
# bind -n C-l select-pane -R

# 창 분할 단축키
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# 레이아웃 단축키
bind m select-layout main-horizontal  # 메인 수평 레이아웃 (하단 패널이 전체 너비 차지)
bind M select-layout main-vertical    # 메인 수직 레이아웃
bind = select-layout tiled            # 모든 패널 동일 크기
bind Space next-layout               # 다음 레이아웃으로 순환
bind r rotate-window                 # 패널 배치 회전 - 상/하 ↔ 좌/우 레이아웃 전환

# vim 스타일 이동 (프리픽스 키 + vim 키)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 패널 이동은 프리픽스 키(Ctrl+E) + vim 키(h/j/k/l)로 사용
# vim 스타일 이동은 위에 이미 설정되어 있음 (bind h select-pane -L 등)

# 추가 이동 단축키 - 방향키
bind Left select-pane -L   # 프리픽스 키 + 왼쪽 화살표
bind Down select-pane -D   # 프리픽스 키 + 아래 화살표
bind Up select-pane -U     # 프리픽스 키 + 위 화살표
bind Right select-pane -R  # 프리픽스 키 + 오른쪽 화살표

# 창 크기 조절 (프리픽스 키 + Shift + 방향키)
bind -r H resize-pane -L 5  # 왼쪽으로 5칸 축소
bind -r J resize-pane -D 5  # 아래로 5칸 확장
bind -r K resize-pane -U 5  # 위로 5칸 확장
bind -r L resize-pane -R 5  # 오른쪽으로 5칸 확장

# 창 크기 조절은 프리픽스 키(Ctrl+E) + Shift + 방향키(H/J/K/L)로 사용
# 위에 이미 설정되어 있음 (bind -r H resize-pane -L 5 등)

# 추가 크기 조절 단축키 - 화살표
bind -r S-Left resize-pane -L 5   # 프리픽스 키 + Shift + 왼쪽 화살표
bind -r S-Down resize-pane -D 5   # 프리픽스 키 + Shift + 아래 화살표
bind -r S-Up resize-pane -U 5     # 프리픽스 키 + Shift + 위 화살표
bind -r S-Right resize-pane -R 5  # 프리픽스 키 + Shift + 오른쪽 화살표

# 패널 위치 변경 (프리픽스 키 + { 또는 })
bind '{' swap-pane -U  # 현재 패널을 이전 패널과 교체
bind '}' swap-pane -D  # 현재 패널을 다음 패널과 교체

# 패널을 새 창으로 분리 (프리픽스 키 + !)
bind ! break-pane    # 현재 패널을 새 창으로 분리

# 창 간 이동 단축키 (프리픽스 키 사용)
bind n next-window            # 프리픽스 키 + n: 다음 창으로 이동
bind p previous-window        # 프리픽스 키 + p: 이전 창으로 이동
bind 1 select-window -t 1     # 프리픽스 키 + 1: 1번 창으로 이동
bind 2 select-window -t 2     # 프리픽스 키 + 2: 2번 창으로 이동
bind 3 select-window -t 3     # 프리픽스 키 + 3: 3번 창으로 이동
bind 4 select-window -t 4     # 프리픽스 키 + 4: 4번 창으로 이동
bind 5 select-window -t 5     # 프리픽스 키 + 5: 5번 창으로 이동

# 패널 위치 변경은 프리픽스 키 + { 또는 }로 사용
# 위에 이미 설정되어 있음 (bind '{' swap-pane -U 등)

# 추가 패널 위치 변경 단축키
bind > swap-pane -D  # 프리픽스 키 + >: 다음 패널과 교체
bind < swap-pane -U  # 프리픽스 키 + <: 이전 패널과 교체

# 색상 테마 (Dracula)
set -g status-style bg=colour236,fg=colour231
set -g window-status-current-style fg=colour231,bg=colour61,bold
set -g pane-border-style fg=colour236
set -g pane-active-border-style fg=colour61,bg=default

# 활성 창 강조 설정
setw -g window-active-style 'bg=#282a36'     # 활성 창 배경색
setw -g window-style 'bg=#1e1f29'           # 비활성 창 배경색(약간 어둡게)

# 상태바 설정
set -g status-left-length 50
set -g status-left "#[fg=colour231,bold] #S "
set -g status-right "#[fg=colour231,bold] %Y-%m-%d %H:%M "
set -g status-justify left

# 시작 인덱스 번호 (창, 패널)
set -g base-index 1
setw -g pane-base-index 1

# 플러그인 설치
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# resurrect 설정
set -g @resurrect-capture-pane-contents 'on'

# continuum 설정
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# 플러그인 초기화
run '~/.tmux/plugins/tpm/tpm'